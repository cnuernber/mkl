<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>mkl.api documentation</title><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-XJYNJF48RM"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XJYNJF48RM');</script><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">MKL</span> <span class="project-version">1.000-beta-3</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="mkl.api.html"><div class="inner"><span>mkl.api</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="mkl.api.html#var-all-distributions"><div class="inner"><span>all-distributions</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-all-rngs"><div class="inner"><span>all-rngs</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-axpy"><div class="inner"><span>axpy</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-axpy.21"><div class="inner"><span>axpy!</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-correlate1d"><div class="inner"><span>correlate1d</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-correlation1d-fn"><div class="inner"><span>correlation1d-fn</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-fft-forward"><div class="inner"><span>fft-forward</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-fft-forward-fn"><div class="inner"><span>fft-forward-fn</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-initialize.21"><div class="inner"><span>initialize!</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-real-.3Ecomplex"><div class="inner"><span>real-&gt;complex</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-rng-stream"><div class="inner"><span>rng-stream</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-sub"><div class="inner"><span>sub</span></div></a></li><li class="depth-1"><a href="mkl.api.html#var-sub.21"><div class="inner"><span>sub!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">mkl.api</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-all-distributions"><h3>all-distributions</h3><div class="usage"><code>(all-distributions)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L266">view source</a></div></div><div class="public anchor" id="var-all-rngs"><h3>all-rngs</h3><div class="usage"><code>(all-rngs)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L262">view source</a></div></div><div class="public anchor" id="var-axpy"><h3>axpy</h3><div class="usage"><code>(axpy mult lhs rhs)</code></div><div class="doc"><div class="markdown"><p>Perform a*x+y where a is a constant and x and y native buffers matching in datatype
and length.  At this time only <code>:float32</code> and <code>:float64</code> datatypes are supported.</p>
<p>Meant to be used within a stack resource context.  See docs for <a href="mkl.api.html#var-sub">sub</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L49">view source</a></div></div><div class="public anchor" id="var-axpy.21"><h3>axpy!</h3><div class="usage"><code>(axpy! mult lhs rhs)</code></div><div class="doc"><div class="markdown"><p>Mutable <a href="mkl.api.html#var-axpy">axpy</a> placing results in rhs.</p>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L28">view source</a></div></div><div class="public anchor" id="var-correlate1d"><h3>correlate1d</h3><div class="usage"><code>(correlate1d data kernel)</code><code>(correlate1d data kernel options)</code></div><div class="doc"><div class="markdown"><p>Drop in replacement for dtype-next's convolve/correlate1d pathway that is significantly
faster for large input data and kernel values.</p>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L251">view source</a></div></div><div class="public anchor" id="var-correlation1d-fn"><h3>correlation1d-fn</h3><div class="usage"><code>(correlation1d-fn dtype nsignal nwin &amp; {:keys [mode algorithm], :or {mode :full, algorithm :auto}})</code></div><div class="doc"><div class="markdown"><p>Create a correlation function that returns data the same length as the input.
This function is <em>not</em> reentrant, do not call simultaneously from multiple threads.</p>
<ul>
<li><code>dtype</code> - One of <code>:float32</code> <code>:float64</code>.</li>
<li><code>nsignal</code> - Length of input signal.</li>
<li>`nwin - Number of elements in the kernel.</li>
</ul>
<p>Options:</p>
<ul>
<li><code>:mode</code> - One of <code>:full</code> <code>:same</code></li>
<li><code>:algorithm</code> - One of <code>:fft</code> <code>:naive</code> <code>:auto</code>.</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L195">view source</a></div></div><div class="public anchor" id="var-fft-forward"><h3>fft-forward</h3><div class="usage"><code>(fft-forward data)</code><code>(fft-forward data options)</code></div><div class="doc"><div class="markdown"><p>Compute the forward fft.  Returns a dtype-next array buffer.  For options see <a href="mkl.api.html#var-fft-forward-fn">fft-forward-fn</a>.
It is a bit faster to use fft-forward-fn and then use the returned function as this initializes
an fft context only once and reuses it.</p>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L181">view source</a></div></div><div class="public anchor" id="var-fft-forward-fn"><h3>fft-forward-fn</h3><div class="usage"><code>(fft-forward-fn dtype domain len)</code></div><div class="doc"><div class="markdown"><p>Create a function to process forward fft.  Returned function takes
one arg, input and returns a pre-allocated output after each invocation.  Input
length must match len.  If domain is complex, input  length must be double
len.</p>
<p>Complex data is stored packed as if in a struct - r1,i1,r2,i2</p>
<ul>
<li><code>dtype</code> - either <code>:float32</code> or <code>:float64</code>.</li>
<li><code>domain</code> - either <code>:real</code> or <code>:complex</code>.</li>
</ul>
<p>Example:</p>
<pre><code class="language-clojure">user&gt; (require '[cnuernber.mkl :as mkl])
Execution error (FileNotFoundException) at user/eval5625 (REPL:43).
Could not locate cnuernber/mkl__init.class, cnuernber/mkl.clj or cnuernber/mkl.cljc on classpath.
user&gt; (require '[mkl.api :as mkl])
nil
user&gt; (mkl/initialize!)
#object[com.sun.proxy.$Proxy3 0x56dd4be7 "Proxy interface to Native Library &lt;libmkl_rt.so@139886755541424&gt;"]
user&gt; (def data (take 100 (cycle [1 2 3 4 5])))
#'user/data
user&gt; (def fft-fn (mkl/fft-forward-fn :float32 :real 100))
#'user/fft-fnJul 21, 2023 3:27:56 PM clojure.tools.logging$eval5978$fn__5981 invoke
INFO: Reference thread starting

user&gt; (def res (fft-fn data))
#'user/res
user&gt; res
#native-buffer@0x00007F39ED2F22D0&lt;float32&gt;[200]
[300.0, 0.000, 0.000, 0.000, 3.104E-07, -3.306E-07, 0.000, 0.000, 1.885E-07, 3.595E-08, 0.000, 0.000, 1.808E-07, -9.941E-08, 0.000, 0.000, -1.462E-07, 1.847E-08, 0.000, 0.000...]
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L112">view source</a></div></div><div class="public anchor" id="var-initialize.21"><h3>initialize!</h3><div class="usage"><code>(initialize!)</code><code>(initialize! options)</code></div><div class="doc"><div class="markdown"><p>Initialize - find the <code>mkl_rt</code> shared library and load it.  Uses normal OS pathways to
find the library in addition to the <code>java_library_path</code> system variable.</p>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L21">view source</a></div></div><div class="public anchor" id="var-real-.3Ecomplex"><h3>real-&gt;complex</h3><div class="usage"><code>(real-&gt;complex real)</code></div><div class="doc"><div class="markdown"><p>Convert a real buffer to an interleaved real-complex buffer - not an efficient operation.</p>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L100">view source</a></div></div><div class="public anchor" id="var-rng-stream"><h3>rng-stream</h3><div class="usage"><code>(rng-stream n {:keys [seed rng dist datatype], :or {rng :sfmt19937, dist :uniform, datatype :float64}, :as options})</code></div><div class="doc"><div class="markdown"><p>Return a function that when called returns a new batch of random numbers.  Returns the same native buffer
on every call.  The values of (all-distributions) state the name of the optional arguments and their
order.</p>
<p>Options:</p>
<p>Note that the distribution arguments <em>must</em> be provided in the optional arguments map.  See the documentation
for various <a href="https://www.intel.com/content/www/us/en/docs/onemkl/developer-reference-c/2023-0/distribution-generators.html">mkl distribution functions</a> for their definitions.</p>
<ul>
<li><code>:datatype</code> - defaults to :float64.</li>
<li><code>:seed</code> - unsigned integer - defaults to unchecked integer cast of system/nanoTime if not provided.</li>
<li><code>:rng</code> - one of (all-rngs) - defaults to :sfmt19937</li>
<li><code>:dist</code> - one of the keys of (all-distributions).  Defaults to :uniform.</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L274">view source</a></div></div><div class="public anchor" id="var-sub"><h3>sub</h3><div class="usage"><code>(sub a b)</code></div><div class="doc"><div class="markdown"><p>Subtract two native buffers.  No care has been taken to ensure buffers are native or to
convert them.</p>
<p>Meant to be used within a stack resource context.</p>
<pre><code class="language-clojure">mkl.api&gt; (def fdata (dt/make-container :native-heap :float32 (hamf/range 100000)))
#'mkl.api/fdata
mkl.api&gt; (crit/quick-bench (resource/stack-resource-context
                            (sub (hamf/subvec fdata 0 (dec (dt/ecount fdata)))
                                 (hamf/subvec fdata 1))))
Evaluation count : 27468 in 6 samples of 4578 calls.
             Execution time mean : 21.781143 µs
    Execution time std-deviation : 82.384894 ns
   Execution time lower quantile : 21.689956 µs ( 2.5%)
   Execution time upper quantile : 21.872100 µs (97.5%)
                   Overhead used : 1.998471 ns
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L75">view source</a></div></div><div class="public anchor" id="var-sub.21"><h3>sub!</h3><div class="usage"><code>(sub! a b ret)</code></div><div class="doc"><div class="markdown"><p>Subtract two native buffers placing result into <code>ret</code>.  See docs for <a href="mkl.api.html#var-sub">sub</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/cnuernber/mkl/blob/master/src/mkl/api.clj#L58">view source</a></div></div></div></body></html>